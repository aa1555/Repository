# ç»“æ„åŒ–æ•°æ®(è¡¨æ ¼)

è¡Œåˆ—ç»“æ„:è¡¨æ ¼çš„æ¯ä¸€åˆ—æœ‰æ˜ç¡®çš„å­—æ®µåå’Œæ•°æ®ç±»å‹ï¼ˆå¦‚æ•°å­—ã€æ—¥æœŸã€æ–‡æœ¬ï¼‰ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€æ¡è®°å½•ï¼Œè®¡ç®—æœºå¯ä»¥å¿«é€Ÿè§£æå’Œæ“ä½œã€‚

# ä»€ä¹ˆæ˜¯æ•°æ®åˆ†æï¼Ÿ

æ•°æ®åˆ†æå°±æ˜¯å°†æ•°æ®è½¬æ¢æˆâ€œæœ‰ç”¨â€ä¿¡æ¯çš„è¿‡ç¨‹ã€‚

å½“ä¸€ä¸ªå‚æ•°é‡Œæœ‰å¤šä¸ªå…ƒç´ æ—¶ï¼Œç”¨[]æ‹¬èµ·æ¥ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå‚æ•°ã€‚å¦‚æœä¸æ‹¬èµ·æ¥ï¼Œå°±æˆäº†å¤šä¸ªå‚æ•°äº†ã€‚

# å•è¯ï¼š

â–²rowï¼šè¡Œ â–²columnï¼šåˆ—â–²separateï¼šåˆ†å¼€ï¼Œåˆ†ç¦»â–²skipï¼šè·³è¿‡â–²Frameï¼šæ¡†æ¶

# æ•°æ®ç±»å‹ä¸æ–°å»ºæ–‡ä»¶
|æ•°æ®ç±»å‹|è¯´æ˜|æ–°å»ºæ–¹æ³•|
|  ----  | ----   | ----  |  
csvã€tsvã€txt|ç”¨é€—å·åˆ†éš”ã€tabåˆ†å‰²çš„çº¯æ–‡æœ¬æ–‡ä»¶|pd.to_csv|
excel|xlsæˆ–xlsx|pd.to_excel|
mysql|å…³ç³»æ•°æ®åº“è¡¨|pd.to_sql|

DataFrameï¼šäºŒç»´æ•°ç»„

arrayï¼šä¸€ç»´æ•°æ®ï¼ˆä¸€åˆ—æˆ–ä¸€è¡Œï¼‰

æ³¨æ„ï¼Œä¸€ç»´æ•°æ®æ˜¯æŒ‡ä¸€åˆ—æˆ–ä¸€è¡Œï¼Œä¸€ç»´æ•°ç»„æ˜¯åªæœ‰ä¸€è¡Œã€‚

## åˆ›å»ºExcel/csv
```python
import pandas as pd                                 
path = 'æ–°å»ºç©ºç™½æ–‡ä»¶.xlsx'                    
data=pd.DataFrame({'åºå·':[1,2,3],'å§“å':['å¶é—®','æå°é¾™','å­™å…´å']})         
data=data.set_index('åºå·')  # å°†idè®¾ç½®ä¸ºç´¢å¼•,å¦‚æœä¸è®¾ç½®ï¼Œå·¦è¾¹ä¼šå¤šå‡ºä¸€ä¸ªç´¢å¼•åˆ—ã€‚
data.to_excel(path)            
print('æ–°å»ºç©ºç™½æ–‡ä»¶.xlsxæˆåŠŸ')     
```
åªæœ‰å®ç°äº†to_excelæ–¹æ³•çš„å¯¹è±¡æ‰èƒ½ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ˜¾ç„¶dataå¯¹è±¡å®ç°äº†è¿™ä¸ªæ–¹æ³• ã€‚

è¿™æ®µä»£ç çš„å…³é”®æ­¥éª¤æ˜¯`data.to_excel(path)` ï¼Œæœ‰äº†è¿™ä¸ªæ­¥éª¤ï¼Œç¼ºdataå°±å»åˆ›å»ºdataï¼Œç¼ºpathå°±å»åˆ›å»ºpathã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‰é¢çš„å¯¼å…¥åº“ï¼Œåˆ›å»ºdataï¼Œåˆ›å»ºpathï¼Œè¿™äº›æ­¥éª¤éƒ½æ˜¯ä¸º`data.to_excel(path)`åšå‡†å¤‡ï¼Œæ²¡æœ‰å®ƒï¼Œå‰é¢çš„å‡†å¤‡ç™½è´¹ã€‚è¿™å°±æ˜¯æ ¹æ®ç›®çš„å€’æ¨ç¨‹åºçš„æ€ç»´æ–¹å¼ã€‚

åˆ›å»ºcsvä¹Ÿæ˜¯ä¸€æ ·ï¼ŒæŠŠExcelæ”¹æˆcsvå°±è¡Œäº†ã€‚

# è¯»å–æ•°æ®ï¼ˆç”¨.read_csvæ–¹æ³•ï¼‰

| æ•°æ®ç±»å‹| 	è¯´æ˜| 	è¯»å–æ–¹æ³•| 
|  ----  | ----   | ----  |  
| csvã€tsvã€txt	| é»˜è®¤é€—å·åˆ†éš”| 	pd.read_csv
| csvã€tsvã€txt| 	é»˜è®¤\tåˆ†éš”| 	pd.read_table
| excel	| xlsæˆ–xlsx| 	pd.read_excel
| mysql	| å…³ç³»æ•°æ®åº“è¡¨| 	pd.read_sql

ä¾‹ï¼š
```python
import pandas as pd
path = 'è¯»å–æ–‡ä»¶.csv'
read_data = pd.read_csv(path,sep=',',header=None,names=['å§“å','å¹´é¾„','åœ°å€','ç”µè¯','å…¥èŒæ—¥æœŸ'],encoding='utf-8',index_col='å…¥èŒæ—¥æœŸ',nrows=3)
print(read_data)        
```
## read_csvçš„å‚æ•°

|å‚æ•°	|æè¿°|
|  ----  | ----   | 
|sep	|åˆ†éš”ç¬¦æˆ–æ­£åˆ™è¡¨è¾¾å¼ sep='\s+'ã€‚å³è®¾ç½®ä»¥ä»€ä¹ˆç¬¦å·åˆ†éš”ã€‚|
|header	|åˆ—å(è¡¨å¤´)çš„è¡Œå·ï¼Œé»˜è®¤0ï¼ˆç¬¬ä¸€è¡Œï¼‰ï¼Œå¦‚æœæ²¡æœ‰åˆ—ååº”è¯¥ä¸ºNoneã€‚å³è®¾ç½®ä»¥ç¬¬å‡ è¡Œä¸ºè¡¨å¤´ï¼Œé»˜è®¤ç¬¬ä¸€è¡Œã€‚|
|names	|åˆ—åï¼ˆè¡¨å¤´ï¼‰ï¼Œä¸header=Noneä¸€èµ·ä½¿ç”¨ã€‚å¦‚æœæ²¡æœ‰è¡¨å¤´ï¼Œå¯ä»¥å°†è¡¨å¤´ä¼ å…¥æœ¬å‚æ•°ï¼Œè‡ªå®šä¹‰è¡¨å¤´ã€‚|
|index_col	|ç´¢å¼•çš„åˆ—å·æˆ–åˆ—åï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå•ä¸€çš„åç§°æˆ–æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ†å±‚ç´¢å¼•ã€‚å³è®¾ç½®ç¬¬å‡ åˆ—ä¸ºç´¢å¼•ã€‚å°†å‚æ•°è®¾ç½®ä¸ºFalseï¼Œå¯ä»¥åœ¨æ–‡æœ¬è¾“å‡ºä¸­ä¸æ˜¾ç¤ºç´¢å¼•ã€‚psï¼šè¡Œçš„ç´¢å¼•æ˜¯åˆ—ï¼Œåˆ—çš„ç´¢å¼•æ˜¯è¡Œã€‚|
|skiprows	|ä»æ–‡ä»¶å¼€å§‹å¤„ï¼Œéœ€è¦è·³è¿‡çš„è¡Œæ•°æˆ–è¡Œå·åˆ—è¡¨ã€‚å³è®¾ç½®å“ªäº›è¡Œä¸éœ€è¦è¯»å–ã€‚|
|encoding	|æ–‡æœ¬ç¼–ç ï¼Œä¾‹å¦‚utf-8|
|nrows	|ä»æ–‡ä»¶å¼€å¤´å¤„è¯»å…¥çš„è¡Œæ•°ã€‚å³éœ€è¦è¯»å–å‰å‡ è¡Œã€‚|

è¿™äº›å‚æ•°æ ¹æ®éœ€è¦ä¼ å…¥ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°è¦æŒ‡å®šè¢«è¯»å–æ–‡ä»¶çš„è·¯å¾„ï¼Œä¸èƒ½çœç•¥ï¼Œå‰©ä¸‹çš„éƒ½å¯ä»¥çœç•¥ã€‚çœç•¥å³ä½¿ç”¨é»˜è®¤å‚æ•°ã€‚

# å†™å…¥æ•°æ®ï¼ˆç”¨.to_excelæ–¹æ³•ï¼‰

è‡ªå·±è®¾ç½®å¹¶å†™å…¥è¡¨å¤´ã€ç¬¬ä¸€ç§æ–¹æ³•ã€‘
```python
import pandas as pd
path = 'c:/pandas/è¯»å–æ–‡ä»¶.xlsx'
read_date = pd.read_excel(path,header=None)
read_date.columns=['åºå·','å§“å','å¹´é¾„','åœ°å€','ç”µè¯','å…¥èŒæ—¥æœŸ']  # ç»™æ¯ä¸ªåˆ—é‡å¤è®¾ç½®è¡¨å¤´
read_date=read_date.set_index('åºå·')          # é‡æ–°æŒ‡å®šç´¢å¼•åˆ—
print(read_date.columns)          # æŸ¥çœ‹åˆ—ååˆ—è¡¨
read_date.to_excel('path')          # å†™å…¥åˆ°Excelæ–‡ä»¶
```
è‡ªå·±è®¾ç½®å¹¶å†™å…¥è¡¨å¤´ã€ç¬¬äºŒç§æ–¹æ³•ã€‘
```python
import pandas as pd
path = 'c:/pandas/è¯»å–æ–‡ä»¶.xlsx'
read_date = pd.read_excel(path,header=None,index_col='åºå·')
read_date.columns=['åºå·','å§“å','å¹´é¾„','åœ°å€','ç”µè¯','å…¥èŒæ—¥æœŸ']  # ç»™æ¯ä¸ªåˆ—é‡å¤è®¾ç½®è¡¨å¤´
read_date=read_date.set_index('åºå·',inplace=True)          # åªåœ¨indexä¸Šé¢æ”¹,ä¸è¦ç”Ÿæˆæ–°çš„
print(read_date.columns)          # æŸ¥çœ‹åˆ—ååˆ—è¡¨ï¼Œindexå’Œcolumnsæ˜¯åˆ†å¼€çš„
read_date.to_excel('path')          # å†™å…¥åˆ°Excelæ–‡ä»¶
```

# pandasæ•°æ®ç»“æ„

## Series

å¸¸ç”¨æ–¹æ³•

```python
date.index #æŸ¥çœ‹ç´¢å¼•
date.values #æŸ¥çœ‹æ•°å€¼
date.isnull() #æŸ¥çœ‹ä¸ºç©ºçš„ï¼Œè¿”å›å¸ƒå°”å‹ï¼Œä¸ºç©ºè¿”å›Tureï¼Œåä¹‹è¿”å›False
date.notnull() # æŸ¥çœ‹ä¸ä¸ºç©º,ä¸ä¸ºç©ºè¿”å›Ture
date.sort_index() #æŒ‰ç´¢å¼•æ’åº
date.sort_values() #æŒ‰æ•°å€¼æ’åº
```

## DataFrame

```python
import pandas as pd
date=pd.DataFrame([[1,2,3],[4,5,6],[7,8,9]],columns=['a','b','c'])  #columnsåˆ—ç´¢å¼•
print(date)  
print(date['a'][0] )   # å–aåˆ—0è¡Œ
print(date.loc[0]['a'] )  # å–0è¡Œï¼Œaåˆ—
print(date.iloc[0][0] )   # å–0è¡Œï¼Œ0åˆ—ï¼Œæ ¹æ®å·å–å€¼ï¼Œä¸æ ¹æ®åˆ—å
print(date[['a','b']])  # å–aåˆ—å’Œbåˆ—ï¼Œè¿™ä¸ªç´¢å¼•å°±æ˜¯ä»¥ä¸€ä¸ªç´¢å¼•çš„åˆ—è¡¨ä½œä¸ºä¸€ä¸ªå…ƒç´ ï¼Œä»£æ›¿ä¸€ä¸ªç´¢å¼•å€¼å…ƒç´ ã€‚
```
`date['a'][0]`:å–aåˆ—0è¡Œ

`date.loc[0]['a']`:å–0è¡Œï¼Œaåˆ—

`date.iloc[0][0]`:å–0è¡Œï¼Œ0åˆ—ï¼Œæ ¹æ®å·å–å€¼ï¼Œä¸æ ¹æ®å

`date[['a','b']]`:å–aåˆ—å’Œbåˆ—

### å¤šä¸ªå­—å…¸åºåˆ—åˆ›å»ºDataFrame
```python

import pandas as pd
dict = {
        'å§“å':['å­™å…´å','æå°é¾™','å¶é—®'],
        'å¹´é¾„':[20,80,127],
        'åŠŸå¤«':['æ’¸é“','æˆªæ‹³é“','å’æ˜¥']
        }
date = pd.DataFrame(dict)
print(date)
print(date.dtypes)    # è¿”å›æ¯ä¸€åˆ—çš„ç±»å‹
print(date.columns) # è¿”å›åˆ—ç´¢å¼•ï¼Œä»¥åˆ—è¡¨å½¢å¼è¿”å›ï¼š[åˆ—å1ï¼Œåˆ—å2ï¼Œâ€¦]
print(date.index)      # è¿”å›è¡Œç´¢å¼•ï¼Œï¼ˆèµ·å§‹ï¼Œç»“æŸï¼Œæ­¥é•¿ï¼‰
```

`date.columns`ï¼šè¿”å›åˆ—ç´¢å¼•

`date.index`ï¼šè¿”å›è¡Œç´¢å¼•

`date.loc[2]['b']`:æŸ¥è¯¢ç¬¬2è¡Œç¬¬båˆ—

## DataFrameå¸¸ç”¨æ–¹æ³•
```python
date.head( 5 ) #æŸ¥çœ‹å‰5è¡Œ
date.tail( 3 ) #æŸ¥çœ‹å3è¡Œ
date.values #æŸ¥çœ‹æ•°å€¼
date.shape #æŸ¥çœ‹è¡Œæ•°ã€åˆ—æ•°
date.fillna(0) #å°†ç©ºå€¼å¡«å……0
date.replace( 1, -1) #å°†1æ›¿æ¢æˆ-1
date.isnull() #æŸ¥æ‰¾æ•°æ®ä¸­å‡ºç°çš„ç©ºå€¼
date.notnull() #éç©ºå€¼
date.dropna() #åˆ é™¤ç©ºå€¼
date.unique() #æŸ¥çœ‹å”¯ä¸€å€¼
date.reset_index() #ä¿®æ”¹ã€åˆ é™¤ï¼ŒåŸæœ‰ç´¢å¼•ï¼Œè¯¦è§ä¾‹1
date.columns #æŸ¥çœ‹æ•°æ®çš„åˆ—å
date.index #æŸ¥çœ‹ç´¢å¼•
date.sort_index() #ç´¢å¼•æ’åº 
date.sort_values() #å€¼æ’åº
pd.merge(æ•°æ®1,æ•°æ®1) #åˆå¹¶
pd.concat([æ•°æ®1,æ•°æ®2]) #åˆå¹¶ï¼Œä¸mergeçš„åŒºåˆ«ï¼Œè‡ªæŸ¥
pd.pivot_table( date ) #ç”¨dfåšæ•°æ®é€è§†è¡¨ï¼ˆç±»ä¼¼äºExcelçš„æ•°é€ï¼‰
```
ä¾‹1ï¼š
```python
import pandas as pd
path = 'c:/pandas/è¯»å–æ–‡ä»¶.xlsx'
read_date = pd.read_excel(path,header=None,names=['åºå·','å§“å','å¹´é¾„','æ‰‹æœº','åœ°å€','å…¥èŒæ—¥æœŸ'],index_col='åºå·')
print(read_date.reset_index(drop=True)) # ç´¢å¼•è¢«ç›´æ¥åˆ é™¤
print(read_date.reset_index(drop=False)) # ç´¢å¼•åˆ—ä¼šè¢«è¿˜åŸä¸ºæ™®é€šåˆ—
```
 


---





# Pandas ç¤ºä¾‹ï¼šé”€å”®æ•°æ®åˆ†æå…¨æµç¨‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„ Pandas ç¤ºä¾‹ï¼Œæ¶µç›–å¤§çº²ä¸­çš„æ‰€æœ‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ˆä»åŸºç¡€æ“ä½œåˆ°é«˜çº§åŠŸèƒ½ï¼‰ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„é”€å”®æ•°æ®åˆ†æé¡¹ç›®ä¸²è”èµ·æ¥ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®æ¼”ç¤ºæ•°æ®å¤„ç†å…¨æµç¨‹ã€‚

## åŠŸèƒ½éœ€æ±‚
1. åˆ›å»ºå’Œæ“ä½œ DataFrameï¼ˆåŸºç¡€æ“ä½œï¼‰ã€‚
2. æ•°æ®æ¸…æ´—ï¼ˆå¤„ç†ç¼ºå¤±å€¼ã€é‡å¤å€¼ã€å¼‚å¸¸å€¼ï¼‰ã€‚
3. æ•°æ®ç±»å‹è½¬æ¢ä¸å­—ç¬¦ä¸²å¤„ç†ã€‚
4. æ•°æ®ç­›é€‰ã€æ’åºå’Œèšåˆã€‚
5. åˆ†ç»„ç»Ÿè®¡ä¸é€è§†è¡¨ã€‚
6. æ—¶é—´åºåˆ—å¤„ç†ã€‚
7. æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚
8. æ•°æ®å¯¼å‡ºä¸å¯è§†åŒ–ï¼ˆç»“åˆ Matplotlibï¼‰ã€‚

## å®Œæ•´ä»£ç 

```python
import pandas as pd
import numpy as np
from datetime import datetime
import matplotlib.pyplot as plt

# ====================== 1. åŸºç¡€æ“ä½œ ======================
# åˆ›å»º DataFrameï¼ˆæ¨¡æ‹Ÿé”€å”®æ•°æ®ï¼‰
data = {
    'Date': ['2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05'],
    'Product': ['A', 'B', 'A', 'C', 'B'],
    'Region': ['East', 'West', 'East', 'North', 'South'],
    'Sales': [100, 200, np.nan, 150, 180],  # åŒ…å«ç¼ºå¤±å€¼
    'Price': [10.5, 20.3, 15.0, 12.8, 18.2]
}
df = pd.DataFrame(data)

# æŸ¥çœ‹æ•°æ®
print("åŸå§‹æ•°æ®ï¼š")
print(df.head())

# ====================== 2. æ•°æ®æ¸…æ´— ======================
# å¤„ç†ç¼ºå¤±å€¼ï¼šå¡«å……é”€å”®é¢çš„ç¼ºå¤±å€¼ä¸ºè¯¥äº§å“çš„å¹³å‡å€¼
product_mean_sales = df.groupby('Product')['Sales'].transform('mean')
df['Sales'] = df['Sales'].fillna(product_mean_sales)

# åˆ é™¤é‡å¤å€¼ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
df = df.drop_duplicates()

# å¤„ç†å¼‚å¸¸å€¼ï¼šå°†é”€å”®é¢å¤§äº200çš„æ ‡è®°ä¸ºå¼‚å¸¸ï¼ˆå‡è®¾200æ˜¯åˆç†ä¸Šé™ï¼‰
df['Is_Outlier'] = df['Sales'] > 200

# ====================== 3. æ•°æ®ç±»å‹è½¬æ¢ä¸å­—ç¬¦ä¸²å¤„ç† ======================
# è½¬æ¢æ—¥æœŸæ ¼å¼
df['Date'] = pd.to_datetime(df['Date'])

# æå–æœˆä»½å’Œå­£åº¦
df['Month'] = df['Date'].dt.month
df['Quarter'] = df['Date'].dt.quarter

# å­—ç¬¦ä¸²æ“ä½œï¼šå°†äº§å“åç§°è½¬ä¸ºå¤§å†™
df['Product'] = df['Product'].str.upper()

# ====================== 4. æ•°æ®ç­›é€‰ä¸æ’åº ======================
# ç­›é€‰ä¸œéƒ¨åœ°åŒºçš„æ•°æ®
east_data = df[df['Region'] == 'East']

# ç­›é€‰é”€å”®é¢å¤§äº150çš„è®°å½•
high_sales = df[df['Sales'] > 150]

# æŒ‰é”€å”®é¢é™åºæ’åº
sorted_df = df.sort_values('Sales', ascending=False)

# ====================== 5. æ•°æ®èšåˆä¸åˆ†ç»„ ======================
# æŒ‰äº§å“åˆ†ç»„è®¡ç®—æ€»é”€å”®é¢å’Œå¹³å‡ä»·æ ¼
product_stats = df.groupby('Product').agg({
    'Sales': ['sum', 'mean'],
    'Price': 'mean'
})
print("\næŒ‰äº§å“åˆ†ç»„çš„ç»Ÿè®¡ï¼š")
print(product_stats)

# å¤šåˆ—åˆ†ç»„ï¼šæŒ‰äº§å“å’Œåœ°åŒºåˆ†ç»„è®¡ç®—é”€å”®æ€»é¢
grouped_stats = df.groupby(['Product', 'Region'])['Sales'].sum().reset_index()
print("\næŒ‰äº§å“å’Œåœ°åŒºåˆ†ç»„çš„é”€å”®æ€»é¢ï¼š")
print(grouped_stats)

# ====================== 6. é€è§†è¡¨ ======================
# åˆ›å»ºé€è§†è¡¨ï¼šäº§å“ vs åœ°åŒºï¼Œæ±‡æ€»é”€å”®é¢
pivot_table = pd.pivot_table(df, values='Sales', index='Product', columns='Region', aggfunc='sum', fill_value=0)
print("\né€è§†è¡¨ï¼šäº§å“ vs åœ°åŒºçš„é”€å”®æ€»é¢")
print(pivot_table)

# ====================== 7. æ—¶é—´åºåˆ—å¤„ç† ======================
# è®¾ç½®æ—¥æœŸä¸ºç´¢å¼•
df_time = df.set_index('Date')

# æŒ‰æœˆä»½é‡é‡‡æ ·è®¡ç®—æœˆåº¦é”€å”®æ€»é¢
monthly_sales = df_time['Sales'].resample('M').sum()
print("\næœˆåº¦é”€å”®æ€»é¢ï¼š")
print(monthly_sales)

# è®¡ç®—7å¤©æ»‘åŠ¨å¹³å‡é”€å”®é¢
rolling_avg = df_time['Sales'].rolling(window=2).mean()  # çª—å£è®¾ä¸º2å¤©ï¼ˆç¤ºä¾‹æ•°æ®è¾ƒå°‘ï¼‰
print("\n2å¤©æ»‘åŠ¨å¹³å‡é”€å”®é¢ï¼š")
print(rolling_avg)

# ====================== 8. æ€§èƒ½ä¼˜åŒ– ======================
# ä½¿ç”¨æ›´é«˜æ•ˆçš„æ•°æ®ç±»å‹ï¼ˆå¦‚å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåˆ†ç±»ç±»å‹ï¼‰
df['Product'] = df['Product'].astype('category')
df['Region'] = df['Region'].astype('category')

# é¿å…é“¾å¼èµ‹å€¼ï¼ˆæ¨èä½¿ç”¨ .locï¼‰
# é”™è¯¯ç¤ºèŒƒï¼šdf[df['Sales'] > 150]['Price'] = 0  # å¯èƒ½æ— æ³•ç”Ÿæ•ˆ
# æ­£ç¡®åšæ³•ï¼š
df.loc[df['Sales'] > 150, 'Price'] = 0  # å°†é«˜é”€å”®é¢äº§å“çš„ä»·æ ¼è®¾ä¸º0ï¼ˆæ¨¡æ‹Ÿä¿ƒé”€ï¼‰

# ====================== 9. æ•°æ®å¯¼å‡º ======================
# å¯¼å‡ºä¸ºCSV
df.to_csv('sales_data_cleaned.csv', index=False)

# å¯¼å‡ºä¸ºExcelï¼ˆå¸¦å¤šä¸ªSheetï¼‰
with pd.ExcelWriter('sales_report.xlsx') as writer:
    df.to_excel(writer, sheet_name='Raw Data', index=False)
    product_stats.to_excel(writer, sheet_name='Product Stats')
    pivot_table.to_excel(writer, sheet_name='Pivot Table')

# ====================== 10. æ•°æ®å¯è§†åŒ– ======================
# ç»˜åˆ¶äº§å“é”€å”®é¢æŸ±çŠ¶å›¾
plt.figure(figsize=(10, 5))
product_sales = df.groupby('Product')['Sales'].sum()
product_sales.plot(kind='bar', color=['blue', 'green', 'red'])
plt.title('Total Sales by Product')
plt.xlabel('Product')
plt.ylabel('Sales (ä¸‡å…ƒ)')
plt.grid(axis='y')
plt.savefig('sales_by_product.png')  # ä¿å­˜å›¾ç‰‡
plt.show()

# ç»˜åˆ¶æ—¶é—´åºåˆ—æŠ˜çº¿å›¾
plt.figure(figsize=(10, 5))
df_time['Sales'].plot(marker='o')
plt.title('Daily Sales Trend')
plt.xlabel('Date')
plt.ylabel('Sales (ä¸‡å…ƒ)')
plt.grid(True)
plt.savefig('sales_trend.png')
plt.show()
```

## ä»£ç è§£æï¼ˆå¯¹åº”å¤§çº²çŸ¥è¯†ç‚¹ï¼‰

| **çŸ¥è¯†ç‚¹**         | **ä»£ç å®ç°**                                                                 |
|--------------------|------------------------------------------------------------------------------|
| åŸºç¡€æ“ä½œ           | DataFrame åˆ›å»ºã€head() æŸ¥çœ‹æ•°æ®ã€‚                                             |
| æ•°æ®æ¸…æ´—           | ç¼ºå¤±å€¼å¡«å…… (fillna)ã€å»é‡ (drop_duplicates)ã€å¼‚å¸¸å€¼æ ‡è®°ã€‚                     |
| æ•°æ®ç±»å‹è½¬æ¢       | to_datetime è½¬æ¢æ—¥æœŸã€astype('category') ä¼˜åŒ–åˆ†ç±»æ•°æ®ã€‚                        |
| å­—ç¬¦ä¸²å¤„ç†         | str.upper() è½¬æ¢äº§å“åç§°ä¸ºå¤§å†™ã€‚                                              |
| æ•°æ®ç­›é€‰ä¸æ’åº     | å¸ƒå°”ç´¢å¼• (df[df['Region'] == 'East'])ã€sort_values() æ’åºã€‚                    |
| æ•°æ®èšåˆ           | groupby() + agg() åˆ†ç»„ç»Ÿè®¡ã€‚                                                  |
| é€è§†è¡¨             | pd.pivot_table() å¤šç»´æ±‡æ€»ã€‚                                                   |
| æ—¶é—´åºåˆ—           | resample() é‡é‡‡æ ·ã€rolling() æ»‘åŠ¨çª—å£è®¡ç®—ã€‚                                   |
| æ€§èƒ½ä¼˜åŒ–           | åˆ†ç±»æ•°æ®ç±»å‹ (astype('category'))ã€é¿å…é“¾å¼èµ‹å€¼ã€‚                              |
| æ•°æ®å¯¼å‡º           | to_csv() å’Œ ExcelWriter å¯¼å‡ºå¤š Sheetã€‚                                         |
| å¯è§†åŒ–             | matplotlib ç»˜åˆ¶æŸ±çŠ¶å›¾å’ŒæŠ˜çº¿å›¾ã€‚                                               |

## ç”Ÿæˆçš„æ–‡ä»¶
- **CSV æ–‡ä»¶**ï¼š`sales_data_cleaned.csv`ï¼ˆæ¸…æ´—åçš„æ•°æ®ï¼‰ã€‚
- **Excel æŠ¥è¡¨**ï¼š`sales_report.xlsx`ï¼ˆåŒ…å«åŸå§‹æ•°æ®ã€ç»Ÿè®¡è¡¨å’Œé€è§†è¡¨ï¼‰ã€‚
- **å›¾ç‰‡**ï¼š`sales_by_product.png` å’Œ `sales_trend.png`ï¼ˆå¯è§†åŒ–ç»“æœï¼‰ã€‚

## å¦‚ä½•æ‰©å±•ï¼Ÿ
1. **å¤§æ•°æ®å¤„ç†**ï¼šç»“åˆ Dask æˆ–åˆ†å—è¯»å– (chunksize) å¤„ç†è¶…å¤§æ•°æ®é›†ã€‚
2. **è‡ªåŠ¨åŒ–æŠ¥å‘Š**ï¼šç”¨ Jupyter Notebook + Markdown ç”Ÿæˆäº¤äº’å¼æŠ¥å‘Šã€‚
3. **æ•°æ®åº“é›†æˆ**ï¼šä» SQL æ•°æ®åº“ç›´æ¥è¯»å–æ•°æ®ï¼ˆpd.read_sql()ï¼‰ã€‚

è¿™ä¸ªç¤ºä¾‹è¦†ç›–äº† Pandas çš„å…¨æµç¨‹æ“ä½œï¼Œé€‚åˆç›´æ¥è¿è¡Œå­¦ä¹ ï¼å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿æé—®ã€‚ ğŸ¼ğŸ“Š
